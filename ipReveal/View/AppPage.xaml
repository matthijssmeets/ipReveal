<?xml version="1.0" encoding="utf-8"?>
<Page
    x:Class="ip_a.View.AppPage"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" xmlns:tv="using:WinUI.TableView"
    mc:Ignorable="d">

    <Grid>

        <Grid.RowDefinitions>
            <RowDefinition Height="225" />
            <RowDefinition Height="*" />
            <RowDefinition Height="10" />
        </Grid.RowDefinitions>

        <StackPanel
            Grid.Row="0"
            Spacing="10">

            <CommandBar
            Background="Transparent"
            HorizontalAlignment="Center">
                <AppBarButton
                    Icon="Copy"
                    Label="Copy"
                    IsEnabled="{x:Bind ViewModel.SecondaryBtnEnabled, Mode=OneWay}"
                    Command="{x:Bind ViewModel.CopyValueCommand}" />
                <AppBarButton
                    Icon="Refresh"
                    Label="Refesh"
                    IsEnabled="{x:Bind ViewModel.PrimaryBtnEnabled, Mode=OneWay}"
                    Command="{x:Bind ViewModel.ResolvePublicIpCommand}" />
                <AppBarButton
                    Icon="Delete"
                    Label="Delete Activity"
                    IsEnabled="{x:Bind ViewModel.SecondaryBtnEnabled, Mode=OneWay}"
                    Command="{x:Bind ViewModel.DeleteRecentActivityCommand}" />
            </CommandBar>

            <TextBlock
                FontSize="40"
                HorizontalAlignment="Center"
                Text="{x:Bind ViewModel.Headline, Mode=TwoWay}" />

            <TextBlock
                FontSize="30"
                HorizontalAlignment="Center"
                Text="{x:Bind ViewModel.Subheadline, Mode=TwoWay}" />

            <InfoBar
                IsOpen="{x:Bind ViewModel.ErrorEnabled, Mode=TwoWay}"
                Severity="Error"
                Title="Error"
                IsClosable="False"
                Message="{x:Bind ViewModel.ErrorMessage, Mode=TwoWay}" />

            <TextBlock
                FontSize="20"
                Text="Recent Activity" />
        </StackPanel>

        <tv:TableView
                Grid.Row="1"
                x:Name="tableView"
                ItemsSource="{x:Bind ViewModel.IpCollection, Mode=TwoWay}"
                SelectionMode="Extended"
                CornerButtonMode="Options"
                IsReadOnly="True"
                ShowExportOptions="True">

            <tv:TableView.RowContextFlyout>
                <MenuFlyout>
                    <MenuFlyoutItem x:Name="deleteRow"
                                            Text="Delete"
                                            Icon="Delete"
                                            Click="OnRowMenuItemClicked" />
                </MenuFlyout>
            </tv:TableView.RowContextFlyout>
        </tv:TableView>

        <ProgressBar
            Grid.Row="2"
            Margin="0,9,0,0"
            IsIndeterminate="{x:Bind ViewModel.ProgressBarEnabled, Mode=TwoWay}" />
    </Grid>
</Page>